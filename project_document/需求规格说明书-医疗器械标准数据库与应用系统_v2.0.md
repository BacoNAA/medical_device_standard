# 医疗器械标准内容信息化数据库及运用系统——需求规格说明书

**文档版本：** v3.0  
**编制日期：** 2025-10-21  
**文档状态：** 草稿  

---

## 目录

[1．引言](#1引言)  
&nbsp;&nbsp;[1.1 编写目的](#11-编写目的)  
&nbsp;&nbsp;[1.2 项目背景](#12-项目背景)  
&nbsp;&nbsp;[1.3 定义](#13-定义)  
&nbsp;&nbsp;[1.4 参考资料](#14-参考资料)  

[2．任务概述](#2任务概述)  
&nbsp;&nbsp;[2.1 目标](#21-目标)  
&nbsp;&nbsp;[2.2 运行环境](#22-运行环境)  
&nbsp;&nbsp;[2.3 条件与限制](#23-条件与限制)  

[3．数据描述](#3数据描述)  
&nbsp;&nbsp;[3.1 静态数据](#31-静态数据)  
&nbsp;&nbsp;[3.2 动态数据](#32-动态数据)  
&nbsp;&nbsp;[3.3 数据库介绍](#33-数据库介绍)  
&nbsp;&nbsp;[3.4 数据词典](#34-数据词典)  
&nbsp;&nbsp;[3.5 数据采集](#35-数据采集)  

[4．功能需求](#4功能需求)  
&nbsp;&nbsp;[4.1 功能划分](#41-功能划分)  
&nbsp;&nbsp;[4.2 功能描述](#42-功能描述)  

[5．性能需求](#5性能需求)  
&nbsp;&nbsp;[5.1 数据精确度](#51-数据精确度)  
&nbsp;&nbsp;[5.2 时间特性](#52-时间特性)  
&nbsp;&nbsp;[5.3 适应性](#53-适应性)  

[6．运行需求](#6运行需求)  
&nbsp;&nbsp;[6.1 用户界面](#61-用户界面)  
&nbsp;&nbsp;[6.2 硬件接口](#62-硬件接口)  
&nbsp;&nbsp;[6.3 软件接口](#63-软件接口)  
&nbsp;&nbsp;[6.4 故障处理](#64-故障处理)  

[7．其它需求](#7其它需求)  

---

# 1．引言

## 1.1 编写目的

为明确软件需求、安排项目规划与进度、组织软件开发与测试，撰写本文档。

本文档的目的是：
- 明确医疗器械标准内容信息化数据库及运用系统的功能需求和性能指标
- 为系统设计、开发、测试、验收提供依据
- 作为项目各方沟通和确认需求的基准文档

本文档供项目经理、产品经理、系统架构师、设计人员、开发人员、测试人员、质量管理人员参考。

## 1.2 项目背景

**a. 项目的委托单位、开发单位和主管部门**

- 委托单位：秦黎 名茜生物
- 开发单位：软件项目管理-第四组
- 主管部门：软件项目管理-第四组

**b. 该软件系统与其他系统的关系**

医疗器械行业标准是医疗器械检验工作的基础，其中的内容数据会运用到不同的场景，例如：
1. 实验室能力评审
2. 实验室操作规程编制
3. 产品技术要求编制

当前，标准内容主要以Word、PDF等文档形式存在，存在以下问题：
- 标准内容分散，查找困难
- 数据结构化程度低，难以重复利用
- 不同应用场景需要手工整理，效率低下
- 缺乏统一的数据管理和权限控制

本系统旨在将医疗器械标准内容结构化入库，建立统一的数据管理平台，支持多场景数据输出，提高工作效率。

## 1.3 定义

本文档中所用到的专门术语定义如下：

| 术语 | 定义 |
|------|------|
| 标准编号 | 医疗器械标准的唯一标识，格式为"标准代号+年代号"，例如"GB 15810-2019"。标准编号必须包含年代号。 |
| 项目条款 | 标准中的条款编号，例如"5.7.1"、"5.7.2"等。 |
| 项目名称 | 标准条款对应的检验项目名称，例如"残留容量"、"器身密合性"等。 |
| 项目要求 | 标准中对检验项目的具体技术要求描述。 |
| 项目方法 | 标准中规定的检验方法，通常引用标准附录。 |
| 标签 | 用于对标准内容进行分类标记的关键词，支持多维度分类和检索。 |
| 产品技术要求（PTR） | Product Technical Requirements，医疗器械制造商根据相关标准自行制定的产品质量要求文档。 |
| 数据输入员 | 负责标准内容录入、维护和修正的系统用户角色，系统仅设1个数据输入员账号。账号格式：`dataadmin`。 |
| 系统管理员 | 负责系统配置、用户管理、权限分配的用户角色，系统仅设1个系统管理员账号。账号格式：`sysadmin`。 |
| 业务人员 | 使用系统浏览标准内容、导出产品技术要求的用户角色。账号格式：`yw###`（yw+3位数字）。 |
| 质量管理人员 | 负责质量管理工作，需要导出能力建设信息网站项目表的用户角色。账号格式：`zl###`（zl+3位数字）。 |
| 设备管理人员 | 负责设备管理工作，需要维护设备信息、导出认可检验检测能力表的用户角色。账号格式：`sb###`（sb+3位数字）。 |
| 实验室人员 | 负责实验室操作，需要导出操作规程表的用户角色。账号格式：`sy###`（sy+3位数字）。 |
| 设备编号 | 设备的唯一标识，格式为"大写字母+3位数字"，例如"A001"。 |
| 自定义输出模板 | 用户可自行配置字段和格式的导出模板，不局限于预设的三种表格格式。 |

## 1.4 参考资料

本文档编制参考的资料包括：

a. 项目相关文档
- 基于医疗器械标准内容的信息化数据库及运用.md（业务需求描述）
- 基于医疗器械标准内容的信息化数据库及运用.pptx（项目说明演示文稿）
- 基于医疗器械标准内容的信息化数据库及运用.docx（项目说明文档）

b. 标准内容示例
- GB 15810-2019《一次性使用无菌注射器》（Excel版本）
- 3GB 15810-2019 一次性使用无菌注射器.xlsx（标准内容结构化示例）
- 3GB 15810-2019 一次性使用无菌注射器.md（标准内容数据字典）

c. 输出格式规范
- 医疗器械产品技术要求格式.md（产品技术要求Word文档格式规范）
- 医疗器械产品技术要求格式.docx（产品技术要求格式模板）

d. 相关标准
- YY0469-2023《医用外科口罩》
- YYT0969-2023《一次性使用医用口罩》

---

# 2．任务概述

## 2.1 目标

本系统的主要目标是：

1. **标准内容结构化管理**
   - 通过半自动导入与链接功能，将CSV/Excel形式的医疗器械标准内容批量录入系统
   - 系统自动解析附录引用、智能识别设备信息，减少人工复制粘贴工作
   - 数据输入员仅需"发起导入"和"微调审核"，大幅提升导入效率
   - 按内容进行分解入库，建立结构化数据库
   - 支持标准编号（必须含年代号）的检索和浏览
   - 支持标签分类管理

2. **权限分级管理**
   - 数据输入员：拥有数据录入、修改权限
   - 业务人员、质量管理人员、设备管理人员、实验室人员：拥有浏览、查询、导出权限
   - 所有用户可提交错误报告，由数据输入员审核处理

3. **多场景数据输出**
   - 支持质量管理人员导出"能力建设信息网站项目表"（表1）
   - 支持设备管理人员导出"认可检验检测能力表"（表2）
   - 支持实验室人员导出"操作规程表"（表3）
   - 支持业务人员编制和导出产品技术要求Word文档

4. **智能辅助编辑**
   - 产品技术要求编辑时，支持关键词联想查找标准内容
   - 自动生成规范化语句，如"试验结果应符合XX的要求"
   - 支持引用式和摘录式两种复用模式

5. **扩展能力（附加目标）**
   - 支持Word形式标准的自动或半自动录入

## 2.2 运行环境

**操作系统：** Windows / Linux

**支持环境：** 
- Web服务器：IIS 10.0 或 Nginx 1.20+
- 应用服务器：.NET 6.0+ / Java 11+ / Node.js 16+

**数据库：** 

- Microsoft SQL Server 2019 或更高版本
- 或 PostgreSQL 14+（待确认）

**客户端要求：**
- 浏览器：Chrome 90+、Edge 90+、Firefox 88+（支持最新2个主版本）
- 屏幕分辨率：1920×1080 或更高
- 网络带宽：建议10Mbps以上

**文件存储：**
- 本地文件系统
- 对象存储服务

## 2.3 条件与限制

**条件：**
1. 标准内容已转换为CSV/Excel格式，按文件类型分组（标准信息、检验要求、附录A-Z等）
2. 每个标准对应一组完整的文件（标准信息、检验要求、相关附录）
3. 附录文件包含章节编号、章节标题、章节内容等结构化字段
4. 产品技术要求模板格式已确定
5. 标准内容的版权使用已获得授权

**限制：**
1. 系统首期支持CSV/Excel格式的批量标准内容导入
2. 一个标准需要提供一组文件（至少包含：标准信息.csv、检验要求.csv、相关附录文件）
3. 智能链接功能依赖规范的附录引用格式（如"附录B"、"B.2"）
4. 设备信息在导入标准时从项目方法或附录中自动识别，识别基于设备关键词库，新设备需人工审核确认后添加到设备库
5. 标准编号必须包含年代号，格式校验严格
6. 设备编号格式固定为"大写字母+3位数字"
7. 产品技术要求导出格式严格遵循规定模板
8. Word版本标准的自动录入功能为附加功能，准确性需人工校验
10. **导入的标准内容仅包含文字数据，不支持图片、图表等非文本内容**
11. **界面设计遵循简洁明了原则，突出核心功能，便于用户快速上手和高效使用**
12. 系统用户规模：数据输入员1人，系统管理员1人，其他角色用户共计不超过20人
13. 账号命名规则：
   - 数据输入员：`dataadmin`
   - 系统管理员：`sysadmin`
   - 业务人员：`yw001`至`yw999`
   - 质量管理人员：`zl001`至`zl999`
   - 设备管理人员：`sb001`至`sb999`
   - 实验室人员：`sy001`至`sy999`

---

# 3．数据描述

## 3.1 静态数据

### 3.1.1 定义说明

**静态数据**是指系统运行过程中**相对固定、变化频率较低**的基础配置数据和元数据。这类数据通常在系统初始化或配置阶段建立，后续仅需少量维护更新。

### 3.1.2 静态数据分类

**1. 用户与角色信息（简化设计）**

**数据描述：** 系统用户的账号、密码、基本信息和角色类型。

**数据内容：**

- **用户账号**（通过账号格式自动识别角色）：
  - `dataadmin`：数据输入员（仅1个账号）→ RoleType = 1
  - `sysadmin`：系统管理员（仅1个账号）→ RoleType = 2
  - `yw###`：业务人员（`yw001`-`yw999`）→ RoleType = 3
  - `zl###`：质量管理人员（`zl001`-`zl999`）→ RoleType = 4
  - `sb###`：设备管理人员（`sb001`-`sb999`）→ RoleType = 5
  - `sy###`：实验室人员（`sy001`-`sy999`）→ RoleType = 6

- **用户基本信息**：
  - 密码（加密存储）
  - 真实姓名
  - 联系电话（可选）
  - 邮箱（可选）
  - 所属部门（可选）
  - 账号状态（启用/停用）

- **角色权限配置**：根据RoleType字段判断权限，无需多表关联查询

- **用户总数限制**：≤22人（1个dataadmin + 1个sysadmin + 最多20个其他用户）

**变化特点：** 用户账号创建后基本稳定，仅在人员入职/离职时增删，密码和基本信息偶尔修改。

**维护角色：** 系统管理员（sysadmin）

---

**2. 系统配置信息**

**数据描述：** 系统运行的参数配置和业务规则配置。

**数据内容：**
- **标签分类体系**：标签的分类结构（如"检验类别"、"设备类型"等）
- **导出模板配置**：表1、表2、表3的字段定义和格式规范
- **产品技术要求段落模板**：常用的标准语句模板（如"试验结果应符合XX的要求"）
- **系统参数设置**：
  - **会话超时时间**（默认30分钟）：用户无操作自动退出登录的时间
  - **文件上传大小限制**（默认5MB）：单个文件上传的最大尺寸
  - **导出文件保留天数**（默认7天）：导出文件在服务器保留的时间，过期自动清理
  - **密码最小长度**（默认6位）：用户密码的最小位数要求

**变化特点：** 系统上线后基本固定，仅在业务规则调整或系统优化时修改。

**维护角色：** 系统管理员（sysadmin）

---

**3. 标准基础信息（元数据）**

**数据描述：** 医疗器械标准的基本属性和元数据，不包括具体的检验项目内容。

**数据内容：**
- **标准编号**（含年代号，如"GB 15810-2019"）
- **标准名称**（中文、英文）
- **国际标准引用型式**（如"ISO 7886-1:1993，MOD"）
- **发布日期、实施日期**
- **适用范围**（标准适用的产品范围描述）
- **规范性引用文件**（标准引用的其他文件清单）
- **前言、引言**等说明性文本

**变化特点：** 标准一旦发布，其基本信息（编号、名称、日期等）基本不变。新版本标准发布时，会新增一条标准记录，旧版本标准的基础信息保持不变。

**与动态数据的区别：**
- 静态数据：标准的**元数据**（标准叫什么、何时发布）
- 动态数据：标准的**内容数据**（具体的检验项目、要求、方法）

**维护角色：** 数据输入员（dataadmin）在导入标准时自动创建，后续仅需少量修正

---

**4. 设备信息**

**数据描述：** 实验室检验设备的基础信息库。

**数据内容：**
- **设备编号**（格式：大写字母+3位数字，如"A001"、"B023"）
- **设备名称**（如"电子天平"、"注射器器身密合性测试仪"）
- **设备规格型号**（如"XS205-赛多利斯"）
- **设备用途说明**（如"用于测量物体质量，精度0.01mg"）

**变化特点：** 设备信息在导入标准时，系统从项目方法或附录中自动识别提取，或由设备管理人员手动增加。设备录入后基本稳定，除非设备报废或更换，否则基本不变。

**维护角色：** 设备管理人员（sb###）、数据输入员（dataadmin）

## 3.2 动态数据

### 3.2.1 定义说明

**动态数据**是指系统运行过程中**频繁变化**的业务操作数据和输出数据。这类数据由用户的日常业务操作产生，随着业务开展不断增加和更新。

### 3.2.2 动态数据分类

动态数据分为**输入数据**和**输出数据**两大类。

---

## 3.2.3 输入数据

输入数据是用户通过各种方式输入到系统的业务数据。

**1. 标准内容数据**

**数据描述：** 医疗器械标准的具体检验项目、要求、方法等核心业务数据。

**来源方式：** Excel/CSV文件批量导入

**数据内容：**
- **项目条款**（如"5.7.1"、"5.7.2"）
- **项目名称**（如"残留容量"、"器身密合性"）
- **项目要求**（检验要求的完整描述）
- **项目方法**（检验方法的完整内容或附录引用）
- **关联附录**（附录A、附录B等详细方法内容）
- **术语定义**（标准中定义的专业术语）

**变化特点：** 
- 新标准不断导入，数据持续增长
- 标准内容更新时（如发现错误），需要修正数据
- 是系统中数据量最大、最核心的业务数据

**数据示例：**
```
标准编号：GB 15810-2019（静态）
项目条款：5.7.1（动态）
项目名称：残留容量（动态）
项目要求：按附录 B 中 B.2 试验，在活塞被完全推入...（动态）
```

**操作角色：** 数据输入员（dataadmin）

---

**2. 设备关联数据**

**数据描述：** 记录"哪个检验项目需要使用哪类设备"的对应关系。

**来源方式：** 
- 批量导入（通过"使用设备.csv"文件）
- 界面手动关联
- 系统智能识别（从方法内容中自动提取设备关键词）

**数据内容：**
每条关联记录包含两个信息：
- **检验项目**（指明是哪个项目，如"GB 15810-2019的5.7.1条款"）
- **设备类型**（指明需要用什么设备，如"高低温试验箱"）

**业务举例：**
```
标准"GB 15810-2019"的"5.7.1条款"需要使用"高低温试验箱"
→ 系统记录：项目"GB 15810-2019-5.7.1" + 设备"高低温试验箱"
```

**说明：**
- 一个检验项目可能需要多种设备（如某项目需要"高低温试验箱"、"电子天平"、"游标卡尺"）
- 一种设备可以被多个项目共用（如"高低温试验箱"可用于多个标准的多个项目）
- 这里的"设备"是指标准中要求的**设备类型/名称**，不是实验室中的具体设备编号
- 系统内部通过项目编号和设备编号进行关联，用户界面会显示标准编号、条款号、设备名称等完整信息

**变化特点：** 
- 每导入一个新标准，都需要建立项目与设备的关联
- 标准更新时，可能增加或删除某些设备要求
- 关联关系相对稳定，主要随标准内容变化而调整

**操作角色：** 数据输入员（dataadmin）

---

**3. 错误报告数据**

**数据描述：** 用户发现标准内容错误时提交的报告。

**来源方式：** 表单提交

**数据内容：**
- **报告编号**（系统自动生成）
- **报告人**（提交用户ID）
- **报告时间**
- **错误位置**（标准编号、项目条款）
- **错误描述**（文本描述）
- **处理状态**（待处理/已修正/已驳回）
- **处理人、处理时间、处理备注**

**变化特点：** 
- 用户使用系统过程中随时可能提交
- 数据量随用户活跃度增长
- 处理后状态会更新

**操作角色：** 
- 提交：所有用户
- 处理：数据输入员（dataadmin）

---

**4. 产品技术要求编辑数据**

**数据描述：** 业务人员编制的产品技术要求文档内容。

**来源方式：** 富文本编辑器编辑

**数据内容：**
- **产品名称**（必填）
- **产品型号/规格及其划分说明**（必填）
- **完整文档内容**（包含第2章性能指标、第3章检验方法、第4章术语、附录等所有章节，存储为富文本）
- **版本号**（如V1.0、V1.1、V2.0...）
- **文档状态**（草稿/已发布）

**说明：**
- 文档内容作为整体存储，不拆分为单独的章节表
- 系统提供智能辅助编辑（联想查找），但不强制记录引用关系
- 版本管理采用简单的版本号机制，不记录详细的版本差异

**变化特点：** 
- 业务人员日常工作中频繁创建和编辑
- 每个产品可能有多个版本
- 内容随产品技术要求的制定和修订而变化

**操作角色：** 业务人员（yw###）

---

## 3.2.4 输出数据

输出数据是系统根据业务需求生成并导出的数据文件和记录。

**1. 表1：能力建设信息网站项目表**

**数据描述：** 质量管理人员导出的项目清单表格。

**输出格式：** Excel (.xlsx)

**表格内容：**
- 项目名称
- 标准编号
- 项目条款

**变化特点：** 每次导出都会生成新的文件和记录

**使用角色：** 质量管理人员（zl###）

---

**2. 表2：认可检验检测能力表**

**数据描述：** 设备管理人员导出的检验能力表格。

**输出格式：** Excel (.xlsx)

**表格内容：**
- 项目名称
- 标准名称
- 标准编号+空格+项目条款
- 使用设备

**变化特点：** 每次导出都会生成新的文件和记录

**使用角色：** 设备管理人员（sb###）

---

**3. 表3：操作规程表**

**数据描述：** 实验室人员导出的操作规程表格。

**输出格式：** Excel (.xlsx)

**表格内容：**
- 标准编号
- 标准名称
- 项目条款
- 项目名称
- 项目要求
- 使用设备
- 项目方法
- 注意事项

**变化特点：** 每次导出都会生成新的文件和记录

**使用角色：** 实验室人员（sy###）

---

**4. 产品技术要求文档**

**数据描述：** 业务人员导出的产品技术要求Word文档。

**输出格式：** Word (.docx)

**文档内容：**
- 产品名称
- 产品型号/规格及其划分说明
- 性能指标
- 检验方法
- 术语
- 附录

**变化特点：** 
- 每次编辑完成后导出
- 同一产品可能导出多个版本

**使用角色：** 业务人员（yw###）

---

**5. 导出历史记录**

**数据描述：** 所有导出操作的历史记录。

**记录内容：**
- 导出时间
- 导出人
- 导出类型（表1/表2/表3/产品技术要求/自定义模板）
- 文件名称
- 文件大小
- 下载链接（7天内有效）

**变化特点：** 
- 每次导出都会新增一条记录
- 记录持续累积，定期归档

**使用角色：** 所有执行导出操作的用户

## 3.3 数据库介绍

本系统使用**关系型数据库**。

数据库名称：`MedicalDeviceStandardDB`

**主要数据表：**

1. **标准信息表（Standard）**
   - 存储标准的基本信息
   - 主键：标准编号（含年代号）

2. **条款信息表（Clause）**
   - 存储标准的条款结构
   - 主键：标准编号+条款编号
   - 外键：标准编号 → Standard

3. **检验项目表（RequirementItem）**
   - 存储具体的检验项目要求
   - 主键：项目ID
   - 外键：标准编号+条款编号 → Clause

4. **检验方法表（Method）**
   - 存储检验方法内容
   - 主键：方法ID
   - 外键：标准编号 → Standard

5. **附录表（Appendix）**
   - 存储标准附录内容
   - 主键：附录ID
   - 外键：标准编号 → Standard

6. **术语定义表（TermDefinition）**
   - 存储标准中的术语和定义
   - 主键：术语ID
   - 外键：标准编号 → Standard

7. **设备信息表（Equipment）**
   - 存储设备信息
   - 主键：设备编号

8. **项目设备关联表（ItemEquipment）**
   - 关联检验项目与使用设备
   - 外键：项目ID → RequirementItem，设备编号 → Equipment

9. **产品技术要求表（PTRDocument）**
   - 存储产品技术要求文档
   - 主键：文档ID
   - 说明：文档内容整体存储，不拆分章节表和引用表

10. **错误报告表（ErrorReport）**
    - 存储用户提交的错误报告
    - 主键：报告ID

11. **用户表（User）**
    - 存储用户账号信息和角色
    - 主键：用户ID
    - 说明：角色通过账号格式自动识别，不需要单独的角色表

12. **操作日志表（OperationLog）**
    - 记录关键操作日志
    - 主键：日志ID

13. **自定义输出模板表（ExportTemplate）**
    - 存储用户创建的导出模板
    - 主键：模板ID

14. **模板字段配置表（TemplateField）**
    - 存储模板的字段配置
    - 主键：字段配置ID
    - 外键：模板ID → ExportTemplate

## 3.4 数据词典

### 3.4.1 标准信息表（Standard）

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 说明 |
|--------|----------|------|------|------|------|
| StandardNo | VARCHAR | 50 | √ | √ | 标准编号（含年代号），如"GB 15810-2019" |
| StandardName | NVARCHAR | 200 | | √ | 标准名称（中文） |
| StandardNameEN | NVARCHAR | 200 | | | 标准名称（英文） |
| ISOReference | NVARCHAR | 200 | | | 国际标准引用型式 |
| PublishDate | DATE | | | | 发布日期 |
| EffectiveDate | DATE | | | | 实施日期 |
| Scope | NTEXT | | | | 适用范围 |
| References | NTEXT | | | | 规范性引用文件 |
| Foreword | NTEXT | | | | 前言 |
| Introduction | NTEXT | | | | 引言 |
| CreatedBy | INT | | | √ | 创建人ID |
| CreatedTime | DATETIME | | | √ | 创建时间 |
| UpdatedBy | INT | | | | 更新人ID |
| UpdatedTime | DATETIME | | | | 更新时间 |

### 3.4.2 检验项目表（RequirementItem）

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 说明 |
|--------|----------|------|------|------|------|
| ItemID | INT | | √ | √ | 项目ID（自增） |
| StandardNo | VARCHAR | 50 | | √ | 标准编号 |
| ClauseNo | VARCHAR | 50 | | √ | 项目条款，如"5.7.1" |
| ItemName | NVARCHAR | 200 | | √ | 项目名称 |
| Requirement | NTEXT | | | √ | 项目要求 |
| MethodRef | NVARCHAR | 500 | | | 项目方法引用，如"附录B"（格式1：仅复杂方法有） |
| MethodContent | NTEXT | | | | 项目方法完整内容（格式2：与要求一一对应） |
| MethodType | TINYINT | | | √ | 方法类型：1-无独立方法，2-引用附录，3-完整方法内容 |
| Notes | NTEXT | | | | 注意事项 |
| SortOrder | INT | | | | 排序号 |
| CreatedTime | DATETIME | | | √ | 创建时间 |
| UpdatedTime | DATETIME | | | | 更新时间 |

**字段说明：**

**MethodType（方法类型）**：
- **1 - 无独立方法**：项目要求中已包含方法说明，无需单独方法字段（如GB 15810-2019的简单项目）
- **2 - 引用附录**：方法以附录形式单独表达，MethodRef字段存储附录编号（如"附录B"、"附录C"）
- **3 - 完整方法内容**：方法与要求一一对应，MethodContent字段存储完整方法描述（如YY 0469-2023口罩标准）

**标准格式差异支持：**

**格式1（如GB 15810-2019注射器标准）**：
- 简单项目：MethodType=1，MethodRef和MethodContent为空
- 复杂项目：MethodType=2，MethodRef="附录B"，MethodContent可存储附录内容摘要

**格式2（如YY 0469-2023口罩标准）**：
- 所有项目：MethodType=3，MethodContent存储完整方法，MethodRef可选择性引用附录（如"见附录A"）

### 3.4.3 术语定义表（TermDefinition）

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 说明 |
|--------|----------|------|------|------|------|
| TermID | INT | | √ | √ | 术语ID（自增） |
| StandardNo | VARCHAR | 50 | | √ | 标准编号 |
| TermCode | VARCHAR | 20 | | √ | 术语编号，如"3.1"、"3.2" |
| TermName | NVARCHAR | 200 | | √ | 术语名称，如"公称容量" |
| TermNameEN | NVARCHAR | 200 | | | 英文术语，如"nominal capacity" |
| Definition | NTEXT | | | √ | 术语定义 |
| Example | NTEXT | | | | 示例 |
| SortOrder | INT | | | | 排序号 |
| CreatedTime | DATETIME | | | √ | 创建时间 |

### 3.4.4 设备信息表（Equipment）

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 说明 |
|--------|----------|------|------|------|------|
| EquipmentCode | CHAR | 4 | √ | √ | 设备编号，格式："[A-Z][0-9]{3}" |
| EquipmentName | NVARCHAR | 200 | | √ | 设备名称 |
| Model | NVARCHAR | 100 | | | 规格型号 |
| Description | NVARCHAR | 500 | | | 用途说明 |
| Status | TINYINT | | | √ | 状态（1:启用，0:停用） |
| CreatedBy | INT | | | √ | 创建人ID |
| CreatedTime | DATETIME | | | √ | 创建时间 |

### 3.4.5 产品技术要求表（PTRDocument）

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 说明 |
|--------|----------|------|------|------|------|
| DocumentID | INT | | √ | √ | 文档ID（自增） |
| ProductName | NVARCHAR | 200 | | √ | 产品名称 |
| ModelSpec | NTEXT | | | √ | 产品型号/规格及其划分说明 |
| Content | NTEXT | | | √ | 完整文档内容（富文本，包含所有章节） |
| Version | VARCHAR | 20 | | √ | 版本号（如V1.0、V1.1、V2.0） |
| Status | TINYINT | | | √ | 状态（0:草稿，1:已发布） |
| CreatedBy | INT | | | √ | 创建人ID |
| CreatedTime | DATETIME | | | √ | 创建时间 |
| UpdatedBy | INT | | | | 更新人ID |
| UpdatedTime | DATETIME | | | | 更新时间 |

**说明：**
- Content字段存储完整的文档内容，包含性能指标、检验方法、术语、附录等所有章节

### 3.4.6 错误报告表（ErrorReport）

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 说明 |
|--------|----------|------|------|------|------|
| ReportID | INT | | √ | √ | 报告ID（自增） |
| ReportNo | VARCHAR | 50 | | √ | 报告编号 |
| StandardNo | VARCHAR | 50 | | √ | 标准编号 |
| ClauseNo | VARCHAR | 50 | | | 条款编号 |
| ErrorDescription | NTEXT | | | √ | 错误描述 |
| Evidence | NVARCHAR | 500 | | | 证据材料路径 |
| ReporterID | INT | | | √ | 报告人ID |
| ReportTime | DATETIME | | | √ | 报告时间 |
| Status | TINYINT | | | √ | 状态（0:待处理，1:已确认，2:已修正，3:已驳回） |
| HandlerID | INT | | | | 处理人ID |
| HandleTime | DATETIME | | | | 处理时间 |
| HandleRemark | NTEXT | | | | 处理备注 |

### 3.4.7 用户表（User）

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 说明 |
|--------|----------|------|------|------|------|
| UserID | INT | | √ | √ | 用户ID（自增） |
| Username | VARCHAR | 50 | | √ | 用户名（唯一，格式决定角色） |
| Password | VARCHAR | 200 | | √ | 密码（加密存储） |
| RealName | NVARCHAR | 50 | | √ | 真实姓名 |
| Phone | VARCHAR | 20 | | | 联系电话 |
| Email | VARCHAR | 100 | | | 邮箱 |
| Department | NVARCHAR | 100 | | | 所属部门 |
| RoleType | TINYINT | | | √ | 角色类型（自动识别） |
| Status | TINYINT | | | √ | 状态（1:启用，0:停用） |
| CreatedBy | INT | | | √ | 创建人ID |
| CreatedTime | DATETIME | | | √ | 创建时间 |
| UpdatedBy | INT | | | | 更新人ID |
| UpdatedTime | DATETIME | | | | 更新时间 |
| LastLoginTime | DATETIME | | | | 最后登录时间 |

**字段说明：**

**RoleType（角色类型）**：系统根据Username格式自动识别并设置
- **1 - 数据输入员**：Username = `dataadmin`
- **2 - 系统管理员**：Username = `sysadmin`
- **3 - 业务人员**：Username格式为 `yw###`（yw + 3位数字）
- **4 - 质量管理人员**：Username格式为 `zl###`（zl + 3位数字）
- **5 - 设备管理人员**：Username格式为 `sb###`（sb + 3位数字）
- **6 - 实验室人员**：Username格式为 `sy###`（sy + 3位数字）

**角色权限对应关系：**

| RoleType | 角色名称 | 账号格式 | 主要权限 |
|----------|---------|---------|---------|
| 1 | 数据输入员 | `dataadmin` | 导入标准数据、维护内容、处理错误报告 |
| 2 | 系统管理员 | `sysadmin` | 用户管理、系统配置、日志查询 |
| 3 | 业务人员 | `yw###` | 浏览标准、编辑产品技术要求、自定义导出 |
| 4 | 质量管理人员 | `zl###` | 浏览标准、导出表1、自定义导出 |
| 5 | 设备管理人员 | `sb###` | 浏览标准、维护设备、导出表2、自定义导出 |
| 6 | 实验室人员 | `sy###` | 浏览标准、导出表3、自定义导出 |

**用户创建流程：**
1. 系统管理员创建用户时输入Username
2. 系统根据Username格式正则匹配自动识别RoleType
3. RoleType一经设置后不可修改

**账号数量限制：**
- `dataadmin`：仅1个
- `sysadmin`：仅1个
- 其他角色：总计不超过20个

### 3.4.8 操作日志表（OperationLog）

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 说明 |
|--------|----------|------|------|------|------|
| LogID | INT | | √ | √ | 日志ID（自增） |
| UserID | INT | | | √ | 操作人ID |
| OperationType | VARCHAR | 50 | | √ | 操作类型（如"导入标准"、"修改数据"） |
| OperationTarget | NVARCHAR | 200 | | | 操作对象（如"GB 15810-2019"） |
| OperationDetail | NTEXT | | | | 操作详情 |
| OperationTime | DATETIME | | | √ | 操作时间 |
| IPAddress | VARCHAR | 50 | | | IP地址 |

### 3.4.9 自定义输出模板表（ExportTemplate）

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 说明 |
|--------|----------|------|------|------|------|
| TemplateID | INT | | √ | √ | 模板ID（自增） |
| TemplateName | NVARCHAR | 100 | | √ | 模板名称 |
| Description | NVARCHAR | 500 | | | 模板说明 |
| IsPublic | BIT | | | √ | 是否公开（1:公开，0:私有） |
| CreatedBy | INT | | | √ | 创建人ID |
| CreatedTime | DATETIME | | | √ | 创建时间 |
| UpdatedBy | INT | | | | 更新人ID |
| UpdatedTime | DATETIME | | | | 更新时间 |
| UseCount | INT | | | √ | 使用次数（默认0） |

### 3.4.10 模板字段配置表（TemplateField）

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 说明 |
|--------|----------|------|------|------|------|
| FieldID | INT | | √ | √ | 字段配置ID（自增） |
| TemplateID | INT | | | √ | 模板ID |
| FieldName | VARCHAR | 50 | | √ | 字段名称（数据库字段名） |
| DisplayName | NVARCHAR | 100 | | √ | 显示名称（列名） |
| FieldOrder | INT | | | √ | 显示顺序 |
| FieldWidth | INT | | | | 字段宽度（像素，0表示自动） |
| Separator | NVARCHAR | 10 | | | 多值分隔符（如"；"） |
| IsCustom | BIT | | | √ | 是否自定义组合字段（1:是，0:否） |
| CustomExpression | NVARCHAR | 500 | | | 自定义字段表达式（如"StandardNo + ' ' + ClauseNo"） |

## 3.5 数据采集

### 3.5.1 Excel/CSV半自动导入与链接

**采集方式：** 通过Web界面批量上传多个CSV/Excel文件

**工作模式：** 数据输入员负责"发起导入"和"审核结果"，系统自动执行解析和链接

**文件组织方式：**
- 一个标准对应一组相关文件（通常10-15个文件）
- 文件格式：.csv（推荐）或.xlsx
- 每个文件包含一类数据（标准信息、检验要求、附录A、附录B等）
- **仅支持纯文本内容，不支持图片、图表等非文本元素**
- **如Excel中包含图片或图表，导入时将被忽略**

**典型文件组成示例（GB 15810-2019）：**

**必需文件（核心数据）：**
1. `标准信息.csv` - 标准的基本信息（标准编号、标准名称、发布日期等）
2. `检验要求.csv` - 所有检验项目的条款、名称、要求

**标准说明性章节文件（视标准内容而定）：**
3. `前言.csv` - 标准前言内容（如标准包含该章节则需提供）
4. `引言.csv` - 标准引言内容（如标准包含该章节则需提供）
5. `范围.csv` - 标准适用范围（如标准包含该章节则需提供）
6. `术语和定义.csv` - 标准术语定义（如标准包含该章节则需提供）
7. `规范性引用文件.csv` - 标准引用的其他文件（如标准包含该章节则需提供）

**附录内容文件（视标准内容而定）：**
8. `附录A.csv` - 附录A的完整内容（如标准包含该附录则需提供）
9. `附录B.csv` - 附录B的完整内容（如标准包含该附录则需提供，含B.1、B.2等子章节）
10. `附录C.csv` - 附录C的完整内容（如标准包含该附录则需提供）
11. ... 其他附录文件（按标准实际包含的附录提供）

**辅助数据文件（可选，用于减少人工审核）：**
12. `项目方法.csv` - 项目方法信息（适用于YY标准格式，可选）
13. `使用设备.csv` - 项目使用设备信息（提供后可减少人工审核工作量，可选）

**数据导入流程：**

**步骤1：上传文件**
- 数据输入员点击"导入新标准"
- 一次性上传该标准的所有CSV/Excel文件（标准信息、检验要求、说明性章节、附录等）
- 点击"上传"按钮

**步骤2：系统自动处理**

系统自动完成以下处理：

1. **读取标准信息**
   - 提取标准编号、名称、日期等基本信息
   - 读取说明性章节（前言、引言、范围、术语和定义、规范性引用文件）
   - 读取所有检验项目

2. **智能关联项目方法**
   - 如提供了`项目方法.csv`：直接按项目条款匹配关联
   - 如未提供：自动识别项目要求中的附录引用（如"按附录B中B.2试验"），自动提取附录内容并关联

3. **智能识别使用设备**
   - 如提供了`使用设备.csv`：直接按项目条款匹配关联
   - 如未提供：从项目方法内容中智能识别设备关键词（如"电子天平"、"显微镜"），自动关联已有设备或标记为新设备

**步骤3：预览与确认**

1. **表格化预览**
   - 系统以表格形式展示所有导入数据
   - 自动标注处理状态：
     - 🟢 绿色：自动处理成功
     - 🟡 黄色：识别到新设备，需确认
     - 🔴 红色：未能自动识别，需人工补充

2. **微调与补充**
   - 仅需处理黄色和红色标注的项目
   - 新设备确认：核对名称、分配编号、添加到设备库
   - 人工补充：填写缺失的方法或设备信息

3. **确认导入**
   - 点击"确认导入"保存到数据库
   - 系统生成导入报告

**去重规则：**

- 标准编号+项目条款作为唯一性约束
- 重复数据可选择：跳过、覆盖、追加版本

### 3.5.2 设备信息录入

**采集方式：** 

1. **标准导入时自动识别和创建**（主要方式）
   - 系统从项目方法或附录内容中自动识别设备关键词
   - 识别到新设备时，提示设备管理人员或数据输入员审核确认
   - 审核通过后自动添加到设备库并建立关联

2. **手动新增**（补充方式）
   - 设备管理人员通过Web界面表单手动录入
   - 用于补充系统未识别到的设备

**录入权限：** 设备管理人员（sb###）、数据输入员（dataadmin）

**字段要求：**
- 设备编号：必填，格式为大写字母+3位数字（如A001）
  - 系统建议下一个可用编号，用户可修改
- 设备名称：必填
  - 自动识别时由系统提取，用户可修改
- 规格型号：可选
- 用途说明：可选

### 3.5.3 项目与设备关联

**采集方式：** 

1. **自动关联**（主要方式）
   - 标准导入时，系统自动识别设备并建立关联
   - 包括从使用设备.csv直接匹配或从项目方法智能识别

2. **手动关联**（补充方式）
   - 通过Web界面选择关联
   - 用于补充或修正自动关联结果

**手动关联操作流程：**
1. 选择标准编号
2. 显示该标准下所有项目列表
3. 为每个项目选择关联的设备（支持多选）
4. 保存关联关系

**操作权限：** 设备管理人员（sb###）、数据输入员（dataadmin）

### 3.5.4 Word文档导入采集（附加功能）

**采集方式：** 通过Web界面上传Word文件

**处理模式：**
- 自动模式：系统自动解析Word文档结构和内容
- 半自动模式：系统解析后人工校对和调整

---

# 4．功能需求

## 4.1 功能划分

本系统按功能模块划分如下：

### 4.1.1 用户管理模块
- 用户登录（按账号格式自动识别角色）
- 用户创建（仅系统管理员）
- 用户信息维护（密码修改、姓名修改）
- 角色分配（通过账号格式自动识别）
- 权限控制

### 4.1.2 标准数据管理模块
- Excel文件导入
- Word文件导入（附加功能）
- 标准信息维护
- 条款信息维护
- 检验项目维护
- 检验方法维护
- 标准内容浏览
- 标准内容检索

### 4.1.3 设备管理模块
- 设备信息维护
- 设备编号管理
- 项目设备关联

### 4.1.4 错误报告管理模块
- 错误报告提交
- 错误报告查询
- 错误报告处理
- 修正记录跟踪

### 4.1.5 数据导出模块
- 能力建设信息网站项目表导出（表1，预设模板）
- 认可检验检测能力表导出（表2，预设模板）
- 操作规程表导出（表3，预设模板）
- 自定义输出模板管理
- 自定义表格导出
- 导出历史记录

### 4.1.6 产品技术要求编辑模块
- 文档创建与编辑
- 模板管理
- 智能联想查找
- 版本管理
- Word文档导出

### 4.1.7 系统管理模块
- 系统参数配置
- 数据字典维护
- 操作日志查询
- 数据备份与恢复

## 4.2 功能描述

### 4.2.1 用户管理功能

#### 4.2.1.1 用户登录

**输入：** 用户名、密码

**处理：** 
- 验证用户名和密码
- 验证账号状态（是否启用）
- **根据账号格式自动识别用户角色：**
  - `dataadmin` → 数据输入员
  - `sysadmin` → 系统管理员
  - `yw###` → 业务人员
  - `zl###` → 质量管理人员
  - `sb###` → 设备管理人员
  - `sy###` → 实验室人员
- 根据角色加载对应的界面和菜单
- 记录登录日志
- 建立会话

**输出：** 
- 登录成功：根据角色进入对应的系统界面（界面布局一致，菜单功能按角色定位）
- 登录失败：提示错误信息

**验收标准：**

- 支持记住密码功能
- 会话超时自动退出（30分钟无操作）
- 角色识别准确率100%
- 不同角色用户登录后看到与其权限匹配的功能菜单

#### 4.2.1.2 用户创建

**用户角色：** 系统管理员（sysadmin）

**输入：**
- 用户名（根据角色选择对应格式）
- 姓名
- 初始密码

**处理：**
- 系统管理员创建新用户账号
- 根据用户名格式自动识别和分配角色：
  - `dataadmin` → 数据输入员
  - `yw###` → 业务人员
  - `zl###` → 质量管理人员
  - `sb###` → 设备管理人员
  - `sy###` → 实验室人员
- 系统生成初始密码或由管理员指定

**输出：**
- 用户创建成功提示
- 账号信息（用户名、初始密码）

**验收标准：**
- 用户名格式自动校验（正则表达式验证）
- 用户名不可重复
- 系统用户总数不超过21人（不含sysadmin）
- 创建成功后用户可正常登录

#### 4.2.1.3 用户信息维护

**用户角色：** 所有用户（自己的信息）、系统管理员（所有用户）

**可修改项：**
- **用户自己可修改：**
  - 姓名
  - 密码
  - 联系电话（可选）
  - 邮箱（可选）
- **系统管理员可修改：**
  - 所有用户的姓名
  - 重置任意用户密码
  - 启用/停用账号

**不可修改项：**
- 用户名（创建后不可修改）
- 角色（由用户名格式决定）

**修改密码流程：**
1. 输入原密码
2. 输入新密码（两次，需一致）
3. 密码强度校验
4. 保存新密码

**验收标准：**
- 修改密码需验证原密码
- 新密码符合强度要求（至少8位，包含字母、数字、特殊字符）
- 修改成功后立即生效
- 系统管理员重置密码后，用户下次登录强制修改

#### 4.2.1.4 角色与权限

**角色定义：**

| 角色 | 账号格式 | 权限说明 |
|------|---------|----------|
| 数据输入员 | `dataadmin` | 导入标准数据、维护标准内容、处理错误报告、修正数据 |
| 系统管理员 | `sysadmin` | 用户管理、角色管理、系统配置、数据备份与恢复、操作日志查询 |
| 业务人员 | `yw###` | 浏览标准内容、检索查询、提交错误报告、编辑和导出产品技术要求、自定义导出 |
| 质量管理人员 | `zl###` | 浏览标准内容、检索查询、提交错误报告、导出表1、自定义导出 |
| 设备管理人员 | `sb###` | 浏览标准内容、检索查询、提交错误报告、维护设备信息、关联设备与项目、导出表2、自定义导出 |
| 实验室人员 | `sy###` | 浏览标准内容、检索查询、提交错误报告、导出表3、自定义导出 |

**说明：**
- 系统仅有1个`dataadmin`账号（数据输入员）
- 系统仅有1个`sysadmin`账号（系统管理员）
- 其他角色用户共计不超过20人
- 角色通过账号格式自动识别，无需手动分配

### 4.2.2 标准数据管理功能

#### 4.2.2.1 标准数据导入

**用户角色：** 数据输入员

**功能说明：** 批量上传CSV/Excel文件，系统自动识别项目方法和使用设备，数据输入员仅需确认结果

**操作步骤：**

1. **上传文件**
   - 点击"导入新标准"
   - 选择该标准的所有文件（标准信息、检验要求、附录等）
   - 上传（支持同时上传10个以上文件）

2. **系统自动处理**
   - 读取标准信息和检验项目
   - 自动识别项目方法（从附录中提取）
   - 自动识别使用设备（从方法内容中提取）
   - 校验数据完整性和格式

3. **预览与确认**
   - 表格形式展示导入数据
   - 颜色标注处理状态：
     - 🟢 绿色：自动处理成功
     - 🟡 黄色：新设备需确认
     - 🔴 红色：需人工补充
   - 仅需处理黄色和红色标注项
   - 点击"确认导入"完成

**验收标准：**
- 支持批量上传10个以上文件
- 自动识别成功率≥80%
- 异常项标注准确

#### 4.2.2.2 标准内容浏览

**用户角色：** 所有用户

**功能说明：** 两级页面展示标准信息，支持搜索、筛选和查看详情

**第一级：标准清单**
- 列表显示所有标准（标准编号、名称、发布日期、项目数量）
- 支持搜索和排序
- 点击进入详情页面

**第二级：标准详情**
- 标准基本信息（编号、名称、发布日期、适用范围等）
- 三个标签页：
  - 检验项目列表（条款、名称、要求、方法、设备）
  - 说明性内容（前言、引言、术语定义等）
  - 附录内容（附录A、附录B等）
- 操作按钮：编辑、导出、报告错误

#### 4.2.2.3 标准内容检索

**用户角色：** 所有用户

**功能说明：** 支持多种条件组合查询标准内容

**检索条件：**
- 标准编号、标准名称（模糊匹配）
- 项目名称、项目条款（精确或模糊）
- 关键词（全文检索）
- 使用设备（下拉选择）

**检索结果：**
- 列表显示匹配结果，关键词高亮
- 支持按相关度排序
- 点击跳转到详情页

**验收标准：** 响应时间≤2秒，准确率≥95%

#### 4.2.2.4 标准内容维护

**用户角色：** 数据输入员

**功能说明：** 编辑和管理已导入的标准数据

**维护功能：**
- 编辑标准基本信息（编号、名称、日期等）
- 编辑检验项目（条款、名称、要求、方法）
- 删除项目（软删除，保留历史）
- 批量编辑

**变更记录：** 记录修改人、时间、修改内容对比，支持历史查询

### 4.2.3 设备管理功能

#### 4.2.3.1 设备信息维护

**用户角色：** 设备管理人员、数据输入员

**功能说明：** 管理实验室设备信息，支持自动识别和手动新增

**新增设备：**
- **方式1（主要）**：导入标准时系统自动识别，用户审核确认
- **方式2（补充）**：手动新增设备

**设备字段：**
- 设备编号（必填，格式：A001，系统自动建议下一个可用编号）
- 设备名称（必填，自动识别时由系统提取）
- 规格型号（可选）
- 用途说明（可选）

**其他功能：** 编辑、启用/停用、删除（已关联项目的设备不可删除）

**验收标准：** 格式实时校验，编号不可重复，保存响应≤1秒

#### 4.2.3.2 项目设备关联

**用户角色：** 设备管理人员、数据输入员

**功能说明：** 建立检验项目与使用设备的对应关系

**关联方式：**
- **自动关联**：导入标准时系统自动识别并建立关联
- **手动关联**：选择项目，勾选设备，保存关联（支持批量）

**界面布局：** 左侧项目树，右侧设备列表

**关联显示：** 项目列表中显示已关联设备图标（绿色=自动，蓝色=手动）

**验收标准：** 自动关联准确率≥70%，支持批量操作

### 4.2.4 错误报告管理功能

#### 4.2.4.1 错误报告提交

**用户角色：** 业务人员、质量管理人员、设备管理人员、实验室人员

**功能说明：** 用户发现标准内容错误时可提交报告

**提交表单：**
- 标准编号、项目条款（自动填充当前查看内容）
- 错误描述（必填）

**提交后：** 生成报告编号，通知数据输入员处理，用户可查询进度

**验收标准：** 提交后可查询进度

#### 4.2.4.2 错误报告处理

**用户角色：** 数据输入员

**功能说明：** 审核和处理用户提交的错误报告

**处理界面：** 待处理报告列表，显示报告详情和原内容对比

**处理方式：**
- **修正**：跳转到编辑页面修改内容，自动更新报告状态
- **驳回**：填写驳回原因，通知报告人

**验收标准：** 处理操作可追溯，通知及时送达

### 4.2.5 数据导出功能

#### 4.2.5.1 表1：能力建设信息网站项目表导出

**用户角色：** 质量管理人员

**功能说明：** 导出质量管理所需的项目清单表

**导出操作：** 选择标准 → 设置筛选条件（可选） → 导出

**输出格式：** Excel（.xlsx）

**表格列：** 项目名称、标准编号、项目条款

**表格预览：** 导出后弹出预览窗口，支持查看、排序、筛选、下载、打印

**验收标准：** 1000行数据导出≤10秒，预览加载≤2秒

#### 4.2.5.2 表2：认可检验检测能力表导出

**用户角色：** 设备管理人员

**功能说明：** 导出检验能力认可所需的设备能力表

**导出操作：** 选择标准 → 设置设备和关键词筛选（可选） → 导出

**输出格式：** Excel（.xlsx）

**表格列：** 项目名称、标准名称、标准编号+项目条款（如"GB 15810-2019 5.7.1"）、使用设备（多个设备用分号分隔）

**表格预览：** 导出后弹出预览窗口，支持查看、排序、筛选、下载、打印

**验收标准：** 字段拼接正确，准确率≥99.5%，预览加载≤2秒

#### 4.2.5.3 表3：操作规程表导出

**用户角色：** 实验室人员

**功能说明：** 导出实验室操作规程所需的完整项目信息表

**导出操作：** 选择标准 → 设置关键词筛选（可选） → 导出

**输出格式：** Excel（.xlsx）

**表格列：** 标准编号、标准名称、项目条款、项目名称、项目要求、使用设备、项目方法、注意事项

**表格预览：** 导出后弹出预览窗口，支持查看、排序、筛选、下载、打印

**验收标准：** 字段内容完整，长文本自动换行，准确率≥99.5%，预览加载≤2秒

#### 4.2.5.4 自定义输出模板管理

**用户角色：** 所有用户

**功能说明：** 创建个性化的导出模板，不局限于预设的表1、表2、表3格式

**创建模板步骤：**
1. **基本信息**：填写模板名称、说明，设置是否公开
2. **字段配置**：选择需要的字段（标准信息、检验项目、设备等），自定义列名和顺序
3. **预览保存**：预览模板效果，保存

**可选字段：** 20+个字段可选（标准编号、名称、项目条款、要求、方法、设备等，支持组合字段如"标准编号+项目条款"）

**模板管理：** 可重复使用，可分享（公开后其他用户可用）

**验收标准：** 支持拖拽排序，保存后立即可用

#### 4.2.5.5 自定义表格导出

**用户角色：** 所有用户

**功能说明：** 使用自定义模板导出数据

**导出流程：** 选择模板（我的/公共/预设） → 设置筛选条件 → 预览数据 → 导出

**表格预览：** 导出后弹出预览窗口，支持查看全部数据、排序、筛选、下载Excel、打印

**验收标准：** 字段与模板一致，1000行导出≤10秒

#### 4.2.5.6 导出历史记录

**功能说明：** 记录所有导出操作，保留文件7天，支持重新下载

**记录内容：** 导出时间、导出人、导出类型、模板名称、文件名、下载链接（7天有效）

**查询功能：** 按时间、导出人、类型、模板名称查询

### 4.2.6 产品技术要求编辑功能

#### 4.2.6.1 文档创建

**用户角色：** 业务人员

**功能说明：** 创建产品技术要求文档，按标准格式生成框架

**创建步骤：** 点击"新建" → 填写产品名称和型号/规格 → 自动生成文档框架

**文档结构：** 1.产品型号/规格、2.性能指标、3.检验方法、4.术语、5.附录（严格按《医疗器械产品技术要求格式》）

**输出：** 进入编辑界面，文档状态为"草稿"

#### 4.2.6.2 内容编辑

**用户角色：** 业务人员

**功能说明：** 编辑产品技术要求文档内容，第2、3章提供智能辅助

**界面布局：** 左侧章节树，中间富文本编辑器，右侧智能辅助面板

**富文本编辑器：** 支持格式设置、插入表格/图片/公式、撤销重做、自动保存（2分钟间隔）

**智能辅助功能（第2章性能指标、第3章检验方法）：**

1. **模板插入**：点击按钮自动插入标准语句模板（如"试验结果应符合XX的要求"）

2. **关键词联想**：
   - 输入项目名称（如"密封性"）
   - 右侧面板显示标准库中的匹配结果
   - 点击"插入要求"或"插入方法"，自动插入标准内容
   - 自动记录引用来源

3. **第3章框架生成**：完成第2章后，点击按钮自动生成第3章框架（项目编号和名称对应）

**其他章节：** 手动填写（第1章产品型号/规格、第4章术语、第5章附录）

**验收标准：** 编辑器稳定不丢内容，自动保存正常，关键词联想≤1秒响应，命中率≥80%

#### 4.2.6.3 版本管理

**功能说明：** 简化的版本管理，每个版本独立存储

**版本规则：** 初始V1.0，小改V1.1/V1.2，大改V2.0/V3.0（用户输入版本号）

**版本操作：** 另存为新版本、查看版本列表、复制版本为新文档

#### 4.2.6.4 Word文档导出

**功能说明：** 导出为标准格式的Word文档

**格式要求：** 严格按《医疗器械产品技术要求格式》
- 页面：A4，边距2.54cm
- 字体：标题宋体小二加粗，一级标题宋体小四加粗，正文宋体小四
- 段落：标题居中，正文左对齐首行缩进2字符行距1.5倍
- 编号：一级1./2./3.，二级1.1/1.2，三级1.1.1/1.1.2
- 页码：页脚居中，格式"x/y"（如"1/9"）
- 空章节不输出标题，附录章节前分页

**文件命名：** `产品技术要求_[产品名称]_V[版本号]_YYYYMMDD.docx`

**验收标准：** 格式完全符合要求，引用内容准确，10页内导出≤5秒，可用Word正常打开

#### 4.2.6.5 权限控制

**权限规则：** 业务人员只能编辑自己创建的文档，数据输入员和系统管理员可查看所有文档（只读）

### 4.2.7 系统管理功能

#### 4.2.7.1 操作日志查询

**用户角色：** 系统管理员

**功能说明：** 查询系统操作日志，支持多条件筛选和导出

**记录操作：** 用户登录/登出、数据导入/修改/导出、文档创建/编辑、错误报告处理等

**日志字段：** 操作时间、操作人、操作类型、操作对象、操作结果、IP地址

**查询功能：** 按时间、操作人、类型、对象查询，可导出Excel

#### 4.2.7.2 系统参数配置

**用户角色：** 系统管理员

**功能说明：** 配置系统运行参数

**可配置项：**
- 会话超时时间（默认30分钟）
- 密码策略（长度、复杂度）
- 文件上传大小限制
- 导出文件保留天数（默认7天）
- 自动保存间隔（默认2分钟）
- 联想查找结果数量（默认5条）

---

# 5．性能需求

## 5.1 响应时间

- 页面加载：≤2秒
- 数据查询：≤2秒
- 数据保存：≤1秒
- 文件导入（1000行）：≤60秒
- 文件导出（1000行）：≤10秒

## 5.2 数据准确性

- 数据导入准确率：≥99%
- 数据导出完整性：不遗漏、不重复
- 精确检索准确率：100%
- 模糊检索准确率：≥95%

## 5.3 并发性能

- 支持并发用户数：20人
- 系统响应时间不因并发访问明显下降
- 数据操作支持事务一致性

## 5.4 可用性与扩展性

- 系统稳定运行，无频繁崩溃
- 数据定期备份，支持恢复
- 界面友好，操作简便
- 支持功能模块扩展

---

# 6．运行需求

## 6.1 用户界面

### 6.1.1 屏幕格式

**登录页面：**
- 居中布局
- 包含：Logo、系统名称、用户名输入框、密码输入框、验证码、登录按钮、记住密码复选框

**系统主界面：**（所有角色界面布局一致）
- 顶部导航栏：Logo、系统名称、用户信息（显示角色）、修改密码、退出按钮
- 左侧菜单栏：功能模块菜单（树形结构，可展开/折叠）
  - **菜单内容根据角色权限动态显示**
  - 不同角色看到的菜单项不同，但界面框架一致
- 中间内容区：显示当前功能页面
- 底部状态栏：版权信息、当前角色、系统时间

**各角色菜单定位：**

| 角色 | 主要菜单项 |
|------|----------|
| 数据输入员（dataadmin） | 标准数据管理、数据导入、内容维护、错误报告处理、标签管理、数据导出 |
| 系统管理员（sysadmin） | 用户管理、角色管理、系统配置、数据备份与恢复、操作日志查询 |
| 业务人员（yw###） | 标准浏览、标准检索、产品技术要求编辑、自定义导出、错误报告提交 |
| 质量管理人员（zl###） | 标准浏览、标准检索、表1导出、自定义导出、错误报告提交 |
| 设备管理人员（sb###） | 标准浏览、标准检索、设备信息维护、设备关联、表2导出、自定义导出、错误报告提交 |
| 实验室人员（sy###） | 标准浏览、标准检索、表3导出、自定义导出、错误报告提交 |

**列表页面：**
- 顶部：面包屑导航、功能按钮区（新增、导出等）
- 中间：查询条件区（可展开/折叠）
- 下方：数据表格（支持排序、分页）
- 表格工具栏：每行操作按钮（查看、编辑、删除）

**表单页面：**
- 标题区：页面标题、保存按钮、取消按钮
- 表单区：分组显示表单字段
- 必填字段标识：红色星号*
- 提示信息：字段右侧或下方显示输入提示

**编辑器页面：**
- 三栏布局：
  - 左侧：章节树（宽度20%）
  - 中间：编辑器（宽度55%）
  - 右侧：辅助面板（宽度25%）
- 顶部工具栏：保存、导出、版本管理

### 6.1.2 报表格式

**Excel导出格式：**
- 第一行：表头（加粗、背景色填充）
- 数据行：从第二行开始
- 列宽：自动调整适应内容
- 文本对齐：居中对齐（表头）、左对齐（数据）
- 边框：所有单元格添加边框

**Word导出格式：**
- 严格按《医疗器械产品技术要求格式》

### 6.1.3 菜单格式

**主菜单：**
- 一级菜单：图标+文字
- 二级菜单：文字，缩进显示
- 当前选中菜单：高亮背景色
- 支持搜索菜单功能

**右键菜单：**
- 在数据列表中，右键弹出快捷菜单
- 包含：查看、编辑、删除、导出等操作

### 6.1.4 输入输出时间

**输入响应：**
- 按键输入实时响应，无延迟感
- 下拉选择立即展开
- 文件选择对话框≤1秒打开

**输出显示：**
- 查询结果≤2秒显示
- 导出文件生成提示立即显示
- 文件准备就绪后提供下载链接

### 6.1.5 界面风格

**设计原则：**
- **简洁明了**：界面布局清晰，去除冗余元素，突出核心功能
- **易于使用**：常用功能一键直达，操作流程简化，减少用户学习成本
- **专业规范**：符合Web设计规范和医疗行业特点
- **色彩搭配协调**：配色简洁大方，视觉舒适
- **响应式设计**：适配不同屏幕尺寸，保持良好的可用性
- **信息层次清晰**：通过字体大小、颜色、间距等手段突出重点信息
- **快速反馈**：操作后立即给予用户明确的反馈提示

**色彩方案：**
- 主色调：蓝色系（专业、可信）
- 辅助色：灰色系（中性）
- 强调色：橙色（操作按钮、重要提示）
- 警告色：红色（错误提示）
- 成功色：绿色（成功提示）

**字体：**
- 中文：微软雅黑、宋体
- 英文/数字：Arial、Times New Roman
- 字号：12px-16px

**交互反馈：**
- 鼠标悬停：按钮/链接颜色变化
- 点击反馈：按钮按下效果
- 加载中：显示加载动画
- 操作成功/失败：弹出提示消息

## 6.2 硬件接口

本系统为Web应用，无需专用硬件设备。

**服务器硬件建议：**
- CPU：2核心及以上
- 内存：4GB及以上
- 硬盘：500GB及以上
- 网络：百兆网卡

**客户端：**
- 任何能运行现代浏览器的PC设备

**打印支持：**
- 支持浏览器打印功能
- 可打印标准内容、产品技术要求等页面

## 6.3 软件接口

### 6.3.1 操作系统接口

- 服务器端：通过IIS、Nginx或Apache部署
- 客户端：通过浏览器访问，无需安装软件

### 6.3.2 数据库接口

- 使用标准数据库连接方式
- 支持事务处理
- 使用ORM框架简化开发

### 6.3.3 文件接口

- Excel文件：使用开源库进行读写
- Word文件：使用开源库生成产品技术要求文档

## 6.4 故障处理

### 6.4.1 数据导入故障

- 文件格式错误：提示用户下载正确模板
- 数据校验失败：生成失败记录清单，用户修正后重新导入
- 部分失败：成功的记录正常入库，失败的记录单独列出

### 6.4.2 编辑冲突处理

- 多用户并发编辑：采用锁机制，后保存的用户提示冲突
- 提供冲突内容对比，用户选择覆盖或放弃

### 6.4.3 导出故障

- 导出失败：提示用户，记录错误日志，支持重试
- 数据量过大：建议分批导出或缩小查询条件

### 6.4.4 系统异常处理

- 捕获所有异常，记录详细日志
- 向用户显示友好的错误提示
- 自动保存草稿，防止数据丢失
- 关键操作提供二次确认

---

# 7．其它需求

## 7.1 可使用性

- 界面直观，符合用户使用习惯
- 输入验证和智能提示
- 关键操作二次确认
- 异常情况友好提示

## 7.2 安全保密

**身份认证：**
- 用户名密码登录
- 密码强度要求（至少8位，包含字母和数字）
- 密码加密存储
- 会话超时自动退出（30分钟）

**权限控制：**
- 基于角色的访问控制（RBAC）
- 最小权限原则
- 数据权限隔离

**数据安全：**
- 数据传输加密（HTTPS）
- 敏感数据加密存储

**审计与备份：**
- 记录所有关键操作
- 定期自动备份数据库
- 支持数据恢复

## 7.3 可维护性

- 代码遵循编码规范，注释清晰
- 模块化设计，低耦合高内聚
- 配置与代码分离，集中管理
- 分级日志记录
- 提供完整的技术文档和用户手册

## 7.4 可移植性

- 服务器端支持Windows和Linux
- 客户端支持多种浏览器和操作系统
- 数据库支持多种主流数据库
- 采用标准化技术和协议，核心逻辑与框架解耦
- 提供数据导出导入工具，支持数据迁移



